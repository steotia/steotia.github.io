---
layout: post
title:  "Content Telemetry Specifications"
date:   2016-04-14 15:21:12 +0530
categories: genie-service sdk android content
---
# Content Events
* [OE_START](##oe_start)
* [OE_END](#oe_end)
* [OE_NAVIGATE](#oe_navigate)
* [OE_LEARN](#oe_learn)
* [OE_ASSESS](#oe_assess)
* [OE_ITEM_RESPONSE](#oe_item_response)
* [OE_EARN](#oe_earn)
* [OE_LEVEL_SET](#oe_level_set)
* [OE_INTERACT](#oe_interact)
* [OE_INTERRUPT](#oe_interrupt)
* [OE_FEEDBACK](#oe_feedback)


Following is an example of an event generated within a content.

```javascript
{
  "eid": "OE_INTERACT", // unique event ID
  "ets": 1442816723,
  "ver": "2.0",
  "gdata": {
     "id": "lit.scrnr.kan.android",
     "ver": "1.0"
  },
  "sid": "de305d54-75b4-431b-adb2-eb6b9e546013",
  "uid": "123e4567-e89b-12d3-a456-426655440000",
  "did": "ff305d54-85b4-341b-da2f-eb6b9e5460fa",
  "edata": {
     "eks":{
        "type": "TOUCH",
        "id": "scene_01",
        "pos": [{"x": 243, "y": 125}]
     }
  }
}
```

# Event Sequence
Here is the standard flow of events in the stack:

```
GE_GENIE_START
    ...| --> genie events such as GE_SIGN_UP, etc may happen
    GE_SESSION_START
        ...| --> genie events such as GE_PROFILE_SET, GE_VIEW_PROGRESS, etc. may happen
        GE_LAUNCH_GAME --> one of the game launched
            OE_START --> events generated by specific game
                ...|
                ...| --> in-game events such as OE_LEARN, OE_NAVIGATE, OE_ASSESS, OE_INTERACT, etc.
                ...|
            OE_END
        GE_GAME_END
        ...| --> genie events such as GE_PROFILE_SET, GE_VIEW_PROGRESS, etc. may happen
        GE_LAUNCH_GAME
            OE_START --> events generated by specific game
                ...|
                ...| --> in-game events such as OE_LEARN, OE_NAVIGATE, OE_ASSESS, OE_INTERACT, etc.
                ...|
            OE_END
        GE_GAME_END
        ...| --> genie events such as GE_PROFILE_SET, GE_VIEW_PROGRESS, etc. may happen
    GE_SESSION_END
    ...| --> genie events such as GE_SIGN_UP, etc may happen
GE_GENIE_END
```

# Event Definitions
Following sections provide exact event specific structures ```edata``` for all events. Generic envelope is defined [here](#telemetry-events).

## OE_START
```javascript
  "edata": {
     "eks":{ // this has no additional data
     }
  }
```

## OE_END
```javascript
  "edata": {
     "eks":{
        "length":  // length of the game session in seconds
     }
  }
```

## OE_NAVIGATE
```javascript
  "edata": {
     "eks":{
        "type": "", // type of event - NEXT, PREVIOUS, SKIP or EXIT
        "itype": "", // type of interaction - SWIPE, SCRUB (fast forward using page thumbnails) or AUTO
        "stageid": "", // game level, stage or page id on which the event happened
        "stageto": "" // game level, stage of page id to which the navigation was done
     }
  }
```

## OE_LEARN
```javascript
  "edata": {
     "eks":{
        "topics":[ // array of concepts being taught
           {
             "mc": "", // unique micro-concept code (from learning map model)
             "methods": [] // learning methods used - PLAY,ANSWER,WRITE,SPEAK,OTHER
           }
        ] // many such concept objects may be there in the array
     }
  }
```

## OE_ASSESS
```javascript
  "edata": {
     "eks":{ // concept that was assessed
        "qid": "", // unique assessment question id. its an required property.
        "pass": "", // Yes, No. This is case-sensitive. default value: No.
        "score": , // score (Integer or decimal) given to this assessment, default is 1 if pass=YES or 0 if pass=NO
        "resvalues": [], // array of key-value pairs that represent child answer (result of this assessment)
        "length": , // time taken (decimal number) for this assessment in seconds
        "exlength": , // expected time (decimal number) in seconds that ideally child should take
        "params": [ // Array of parameter tuples
           {"id":"value"} // for ex: if var1 is substituted with 5 apples the parameter is {"var1":"5"}
        ],
        "qindex": , // index of the question in a given questions set. default value is 0
        "uri": "" // Unique external resource identifier if any (for recorded voice, image, etc.)
     }
  }
```

## OE_ITEM_RESPONSE
```javascript
  "edata": {
     "eks":{
        "qid": "", // unique assessment question id
        "type": "", // type of interaction. CHOOSE,DRAG,SELECT,MATCH,INPUT,SPEAK,WRITE
        "state": "", // state of the response (SELECTED, UNSELECTED) - to allow the child to unselect an option
        "resvalues": [ // Array of response tuples
           {"id":"value"} // for ex: if lhs option1 is matched with rhs optionN - [{"lhs":"option1"}, {"rhs":"optionN"}]
        ]
     }
  }
```

**Examples**

* MCQ - User selects option1 and option2 in an MCQ question
`Type=CHOOSE, resvalues=[{"option": "option1"}, {"option": "option2"}], state=SELECTED`

* MCQ Question Unselected - User toggles option1 and option2 (unselects them)
`Type=CHOOSE, resvalues=[{"option": "option1"}, {"option": "option2"}], state=UNSELECTED`

* MTF Question - User drags RHS optionN and drops to lhs option1
`Type=MATCH, resvalues=[{"lhs":"option1"}, {"rhs":"optionN"}]`

* Fill in the blank - Question has two input fields, num1 and num2, and user enters 5 and 10 respectively
`Type=INPUT, resvalues=[{"num1": "5"}, {"num2": "10"}]`

* Note - In these cases, there is no need to generate OE_INTERACT separately

## OE_EARN
```javascript
  "edata": {
     "eks":{ // need to define this. not fully analyzed yet.
        "type": "", // type of points earned by child. MONEY,GEMS,POINTS
        "points": 0 // amount earned.
     }
  }
```

## OE_LEVEL_SET
```javascript
  "edata": {
     "eks":{
        "category": "" , // category for which level is set. Game can have multiple levels across categories
        "current": "", // current level of child
        "max": "" // max levels offered within the game, -1 if no max levels
     }
  }
```

## OE_INTERACT
```javascript
  "edata": {
     "eks":{
        "stageid": "", // game level, stage or page id on which the event happened
        "type": "", // type of interaction TOUCH,DRAG,DROP,PINCH,ZOOM,SHAKE,ROTATE,SPEAK,LISTEN,WRITE,DRAW,START,END,CHOOSE,ACTIVATE,SHOW,HIDE,OTHER
        "subtype": "", // additional types for a global type. For ex: for an audio the type is LISTEN and the subtype can be one of PLAY,PAUSE,STOP,RESUME
        "extype": "", // expected interaction type if different from the childÂ’s response
        "pos": [{"x":,"y":,"z":}], // Array of positional attributes. For ex: Drag and Drop has two positional attributes. One where the drag has started and the drop point
        "values": [], // Array of values, e.g. for timestamp of audio interactions
        "id": "", // resource (button, screen, page, etc) id on which the interaction happened - use system identifiers when reporting device events
        "tid": "", // when interaction is between multiple resources, (e.g. drag and drop) - target resource id
        "uri": "" // Unique external resource identifier if any (for recorded voice, image, etc.)
     }
  }
```

**Examples**

**Drag and Drop**
* On Drag start - User starts dragging res1 from x,y position
`type=DRAG, id=res1, pos x,y of the origin`

* On Drop - User drops res1 on a drop-area res2
`type=DROP, id=res1 and tid=res2, pos x,y of the drop location`

* On Drop - User drops res1 on an invalid drop-area (in most cases, res1 will snap-to origin x,y)
`type=DROP, id=res1 and tid=NULL, pos x,y of the drop location`

**Pressing device home button to exit**
* Interact event, type=END, subtype=app specific, id=DEVICE_HOME_BTN, stageid=game stage on which the home button was pressed

## OE_INTERRUPT
```javascript
  "edata": {
     "eks":{
        "type": "", // app interruption type enum - IDLE,SLEEP,CALL,SWITCH,LOCK,OTHER
        "stageid": "", // game level, stage or page id on which the event happened
     }
  }
```

## OE_FEEDBACK
```javascript
  "edata": {
    "eks":{
       "type": "", // Type of feedback. FLAG, SURVEY, RATING
       "rating": 123, // Numeric score (+1 for like, -1 for dislike, or 4.5 stars given in a rating)
       "context": "", // identifier for any specific context - eg. a particular screen, content or a specific question
       "comments": "" // Text feedback (if any)
       "res": [ // Array of response tuples
           {"id":"value"} // for ex: in case of a survey, this could include response to each question
        ]
    }
  }
```
